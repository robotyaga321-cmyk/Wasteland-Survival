<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wasteland Scavenger</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #1a1a2e;
            color: #e0e0e0;
            font-family: 'Roboto Mono', monospace;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        #game-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 10px;
        }

        #stats {
            display: flex;
            justify-content: space-around;
            background: #282846;
            padding: 10px;
            border-bottom: 1px solid #3a3a5e;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .stat-item {
            text-align: center;
            flex: 1;
        }
        .stat-value {
            font-weight: bold;
            color: #00ffaa;
        }

        #game-log {
            background: #0f0f1f;
            border: 1px solid #3a3a5e;
            padding: 10px;
            height: 150px;
            overflow-y: auto;
            margin-bottom: 10px;
            border-radius: 8px;
            font-size: 13px;
            color: #b0b0b0;
        }
        .log-message {
            margin-bottom: 5px;
        }
        .log-event { color: #00ffaa; }
        .log-danger { color: #ff5555; }
        .log-info { color: #88ddff; }

        #main-display {
            flex-grow: 1;
            background: #1a1a2e;
            border: 1px solid #3a3a5e;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 16px;
        }
        #current-location {
            font-size: 20px;
            font-weight: bold;
            color: #e0e0e0;
            margin-bottom: 10px;
        }
        #location-desc {
            color: #b0b0b0;
        }
        #location-image {
            width: 80px;
            height: 80px;
            background-color: #3a3a5e;
            border-radius: 12px;
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
        }

        #actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 10px;
        }
        .action-btn {
            background: #0088cc;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 15px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .action-btn:hover { background: #00aaff; }
        .action-btn:disabled { background: #3a3a5e; cursor: not-allowed; }

        #inventory {
            background: #282846;
            padding: 10px;
            border-top: 1px solid #3a3a5e;
            font-size: 13px;
            border-radius: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .inventory-item {
            background: #3a3a5e;
            padding: 5px 8px;
            border-radius: 5px;
            color: #ddd;
            display: flex;
            align-items: center;
        }
        .item-icon { margin-right: 5px; }
        .item-count { margin-left: 5px; color: #00ffaa; }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="stats">
            <div class="stat-item">HP: <span id="hp-val" class="stat-value">100</span></div>
            <div class="stat-item">Energy: <span id="energy-val" class="stat-value">100</span></div>
            <div class="stat-item">Water: <span id="water-val" class="stat-value">100</span></div>
            <div class="stat-item">Food: <span id="food-val" class="stat-value">100</span></div>
        </div>

        <div id="game-log"></div>

        <div id="main-display">
            <div id="location-image">?</div>
            <div id="current-location">Loading...</div>
            <div id="location-desc">Welcome to the Wasteland.</div>
        </div>

        <div id="actions">
            <button class="action-btn" id="explore-btn">üó∫Ô∏è Explore</button>
            <button class="action-btn" id="scavenge-btn">üîç Scavenge</button>
            <button class="action-btn" id="rest-btn">‚õ∫ Rest</button>
            <button class="action-btn" id="craft-btn">üî® Craft</button>
        </div>

        <div id="inventory">
            <span style="color:#888;">Inventory:</span>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        // --- Game State (–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã) ---
        let player = {
            hp: 100,
            maxHp: 100,
            energy: 100,
            maxEnergy: 100,
            water: 100,
            maxWater: 100,
            food: 100,
            maxFood: 100,
            inventory: {
                'scrap': 0,
                'water_bottle': 0,
                'mutant_meat': 0,
                'medkit': 0
            },
            currentLocation: 'starting_zone',
            day: 1
        };

        const locations = {
            'starting_zone': { name: 'Abandoned Outpost', desc: 'A ruined outpost, some scraps might remain.', icon: 'üèöÔ∏è' },
            'dry_riverbed': { name: 'Dry Riverbed', desc: 'A long-forgotten river, maybe some rare minerals here.', icon: 'üíÄ' },
            'irradiated_forest': { name: 'Irradiated Forest', desc: 'Strange mutated flora and fauna. Danger.', icon: 'üå≥' },
            'ruined_city': { name: 'Ruined City', desc: 'Collapsed skyscrapers, dangerous but resource-rich.', icon: 'üè¢' }
        };

        const craftRecipes = {
            'water_bottle': { requires: { 'scrap': 2 }, makes: { 'water_bottle': 1 }, energyCost: 5, successMsg: 'Crafted a water bottle!' },
            'medkit': { requires: { 'scrap': 3, 'mutant_meat': 1 }, makes: { 'medkit': 1 }, energyCost: 10, successMsg: 'Assembled a basic medkit.' }
        };

        // --- UI Elements (–≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞) ---
        const hpVal = document.getElementById('hp-val');
        const energyVal = document.getElementById('energy-val');
        const waterVal = document.getElementById('water-val');
        const foodVal = document.getElementById('food-val');
        const gameLog = document.getElementById('game-log');
        const mainDisplay = document.getElementById('main-display');
        const currentLocationEl = document.getElementById('current-location');
        const locationDescEl = document.getElementById('location-desc');
        const locationImageEl = document.getElementById('location-image');
        const actionsDiv = document.getElementById('actions');
        const inventoryDiv = document.getElementById('inventory');

        // --- Game Functions (–ò–≥—Ä–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏) ---

        function updateUI() {
            hpVal.innerText = player.hp;
            energyVal.innerText = player.energy;
            waterVal.innerText = player.water;
            foodVal.innerText = player.food;

            const loc = locations[player.currentLocation];
            currentLocationEl.innerText = loc.name;
            locationDescEl.innerText = loc.desc;
            locationImageEl.innerText = loc.icon;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            let invHTML = '<span style="color:#888;">Inventory:</span>';
            for (const item in player.inventory) {
                if (player.inventory[item] > 0) {
                    const itemIcon = getItemIcon(item);
                    invHTML += `<div class="inventory-item"><span class="item-icon">${itemIcon}</span>${item}<span class="item-count">x${player.inventory[item]}</span></div>`;
                }
            }
            inventoryDiv.innerHTML = invHTML;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ (–æ—Ç–∫–ª—é—á–∏—Ç—å, –µ—Å–ª–∏ –Ω–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏/—Ä–µ—Å—É—Ä—Å–æ–≤)
            document.getElementById('explore-btn').disabled = player.energy < 10;
            document.getElementById('scavenge-btn').disabled = player.energy < 5;
            document.getElementById('rest-btn').disabled = player.energy >= player.maxEnergy;
            document.getElementById('craft-btn').disabled = !canCraftAnything(); // –û—Ç–∫–ª—é—á–∞–µ–º, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ–ª—å–∑—è —Å–∫—Ä–∞—Ñ—Ç–∏—Ç—å
        }

        function logMessage(message, type = 'log-info') {
            const msgEl = document.createElement('div');
            msgEl.classList.add('log-message', type);
            msgEl.innerText = message;
            gameLog.prepend(msgEl); // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ
            if (gameLog.children.length > 50) gameLog.lastChild.remove(); // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ª–æ–≥
        }

        function consumeResources(energyCost, waterCost = 10, foodCost = 10) {
            player.energy -= energyCost;
            player.water -= waterCost;
            player.food -= foodCost;

            if (player.energy < 0) player.energy = 0;
            if (player.water < 0) player.water = 0;
            if (player.food < 0) player.food = 0;
            
            checkSurvivalConditions();
        }

        function checkSurvivalConditions() {
            if (player.water === 0) {
                player.hp -= 5;
                logMessage('You are dehydrated! Losing HP.', 'log-danger');
            }
            if (player.food === 0) {
                player.hp -= 5;
                logMessage('You are starving! Losing HP.', 'log-danger');
            }
            if (player.hp <= 0) {
                gameOver();
            }
            player.hp = Math.min(player.hp, player.maxHp); // –ù–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å –º–∞–∫—Å–∏–º—É–º
            player.energy = Math.min(player.energy, player.maxEnergy);
            player.water = Math.min(player.water, player.maxWater);
            player.food = Math.min(player.food, player.maxFood);
        }

        function gameOver() {
            logMessage(`--- GAME OVER --- You survived for ${player.day} days.`, 'log-danger');
            actionsDiv.innerHTML = '<button class="action-btn" onclick="restartGame()">Restart</button>';
            tg.HapticFeedback.notificationOccurred('error');
        }

        function restartGame() {
            localStorage.clear(); // –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            location.reload(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
        }

        function getItemIcon(item) {
            switch(item) {
                case 'scrap': return '‚öôÔ∏è';
                case 'water_bottle': return 'üíß';
                case 'mutant_meat': return 'ü•©';
                case 'medkit': return 'ü©π';
                default: return '‚ùì';
            }
        }
        
        function canCraftAnything() {
            for (const recipeName in craftRecipes) {
                const recipe = craftRecipes[recipeName];
                let canMake = true;
                for (const reqItem in recipe.requires) {
                    if (player.inventory[reqItem] < recipe.requires[reqItem]) {
                        canMake = false;
                        break;
                    }
                }
                if (canMake) return true;
            }
            return false;
        }

        // --- Actions (–î–µ–π—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–∞) ---

        document.getElementById('explore-btn').onclick = () => {
            if (player.energy < 10) { logMessage('Not enough energy to explore!', 'log-danger'); return; }
            consumeResources(10);
            tg.HapticFeedback.impactOccurred('medium');

            logMessage('You ventured into the unknown...', 'log-event');
            
            // –°–ª—É—á–∞–π–Ω–∞—è —Å–º–µ–Ω–∞ –ª–æ–∫–∞—Ü–∏–∏
            const newLocs = Object.keys(locations).filter(loc => loc !== player.currentLocation);
            player.currentLocation = newLocs[Math.floor(Math.random() * newLocs.length)];

            // –°–ª—É—á–∞–π–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
            const eventRoll = Math.random();
            if (eventRoll < 0.3) { // –ù–∞—à–ª–∏ —á—Ç–æ-—Ç–æ
                const itemFound = Math.random() < 0.5 ? 'scrap' : 'mutant_meat';
                const amount = Math.floor(Math.random() * 3) + 1;
                player.inventory[itemFound] += amount;
                logMessage(`Found ${amount} ${getItemIcon(itemFound)} ${itemFound}!`, 'log-event');
            } else if (eventRoll < 0.5) { // –í—Ä–∞–≥
                const damage = Math.floor(Math.random() * 20) + 10;
                player.hp -= damage;
                logMessage(`A mutated creature attacked! Lost ${damage} HP.`, 'log-danger');
            } else { // –ù–∏—á–µ–≥–æ
                logMessage('Found nothing of interest.', 'log-info');
            }
            
            updateUI();
        };

        document.getElementById('scavenge-btn').onclick = () => {
            if (player.energy < 5) { logMessage('Too tired to scavenge!', 'log-danger'); return; }
            consumeResources(5);
            tg.HapticFeedback.impactOccurred('light');

            logMessage('You meticulously searched the area.', 'log-event');
            
            const scrapFound = Math.floor(Math.random() * 5) + 1;
            player.inventory['scrap'] += scrapFound;
            logMessage(`Found ${scrapFound} ‚öôÔ∏è scrap!`, 'log-event');
            
            updateUI();
        };

        document.getElementById('rest-btn').onclick = () => {
            if (player.energy >= player.maxEnergy) { logMessage('You are already fully rested!', 'log-info'); return; }
            consumeResources(0, 5, 5); // –¢–æ–ª—å–∫–æ –≤–æ–¥–∞ –∏ –µ–¥–∞
            tg.HapticFeedback.impactOccurred('medium');

            const energyRestored = Math.min(50, player.maxEnergy - player.energy);
            player.energy += energyRestored;
            player.hp += 10; // –ù–µ–º–Ω–æ–≥–æ HP –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
            player.day++;

            logMessage(`You rested for the day. Energy +${energyRestored}, HP +10. Day ${player.day}.`, 'log-event');
            updateUI();
        };

        document.getElementById('craft-btn').onclick = () => {
            let craftOptions = '';
            for (const recipeName in craftRecipes) {
                const recipe = craftRecipes[recipeName];
                let canMake = true;
                let reqString = [];
                for (const reqItem in recipe.requires) {
                    reqString.push(`${recipe.requires[reqItem]} ${getItemIcon(reqItem)} ${reqItem}`);
                    if (player.inventory[reqItem] < recipe.requires[reqItem]) {
                        canMake = false;
                    }
                }
                const makeItem = Object.keys(recipe.makes)[0];
                const makeCount = recipe.makes[makeItem];
                
                craftOptions += `<button class="action-btn" ${!canMake ? 'disabled' : ''} onclick="performCraft('${recipeName}')">
                                    Craft ${makeCount} ${getItemIcon(makeItem)} ${makeItem} (Cost: ${reqString.join(', ')})
                                </button>`;
            }
            
            // –ó–∞–º–µ–Ω—è–µ–º –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏ –∫—Ä–∞—Ñ—Ç–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ
            actionsDiv.innerHTML = craftOptions + `<button class="action-btn" onclick="hideCraftOptions()">Back</button>`;
        };

        function performCraft(recipeName) {
            const recipe = craftRecipes[recipeName];
            if (!recipe) return;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
            for (const reqItem in recipe.requires) {
                if (player.inventory[reqItem] < recipe.requires[reqItem]) {
                    logMessage(`Not enough ${getItemIcon(reqItem)} ${reqItem} to craft!`, 'log-danger');
                    tg.HapticFeedback.notificationOccurred('error');
                    return;
                }
            }
            if (player.energy < recipe.energyCost) {
                logMessage('Not enough energy to craft!', 'log-danger');
                tg.HapticFeedback.notificationOccurred('error');
                return;
            }

            // –¢—Ä–∞—Ç–∏–º —Ä–µ—Å—É—Ä—Å—ã
            for (const reqItem in recipe.requires) {
                player.inventory[reqItem] -= recipe.requires[reqItem];
            }
            player.energy -= recipe.energyCost;

            // –°–æ–∑–¥–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç
            for (const makeItem in recipe.makes) {
                player.inventory[makeItem] += recipe.makes[makeItem];
            }
            logMessage(recipe.successMsg, 'log-event');
            tg.HapticFeedback.impactOccurred('heavy');
            hideCraftOptions(); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ã—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            updateUI();
        }

        function hideCraftOptions() {
            actionsDiv.innerHTML = `
                <button class="action-btn" id="explore-btn">üó∫Ô∏è Explore</button>
                <button class="action-btn" id="scavenge-btn">üîç Scavenge</button>
                <button class="action-btn" id="rest-btn">‚õ∫ Rest</button>
                <button class="action-btn" id="craft-btn">üî® Craft</button>
            `;
            // –ü–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
            document.getElementById('explore-btn').onclick = actions.explore;
            document.getElementById('scavenge-btn').onclick = actions.scavenge;
            document.getElementById('rest-btn').onclick = actions.rest;
            document.getElementById('craft-btn').onclick = actions.craft;
            updateUI();
        }


        // --- Save/Load (–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–ó–∞–≥—Ä—É–∑–∫–∞) ---
        function saveGame() {
            localStorage.setItem('wasteland_savestate', JSON.stringify(player));
            logMessage('Game saved!', 'log-info');
        }

        function loadGame() {
            const savedState = localStorage.getItem('wasteland_savestate');
            if (savedState) {
                player = JSON.parse(savedState);
                logMessage('Game loaded!', 'log-info');
            } else {
                logMessage('No saved game found. Starting new game.', 'log-info');
            }
        }

        // --- Initialization (–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è) ---
        loadGame();
        updateUI();

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(saveGame, 30000);
        // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ä–∞—Å—Ö–æ–¥ —Ä–µ—Å—É—Ä—Å–æ–≤
        setInterval(checkSurvivalConditions, 60000); // –†–∞–∑ –≤ –º–∏–Ω—É—Ç—É –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –≥–æ–ª–æ–¥/–∂–∞–∂–¥—É

        // –ü–µ—Ä–µ–ø—Ä–∏–≤—è–∑–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ (—Ç.–∫. –∫–Ω–æ–ø–∫–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—é—Ç—Å—è)
        // –î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –≤ HTML (onclick), 
        // –Ω–æ –ø—Ä–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–º–µ–Ω–µ –∏—Ö –Ω—É–∂–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ.
        // –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –æ–Ω–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ hideCraftOptions
        
        // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã, –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –∑–∞–º–µ–Ω–µ–Ω—ã.
        // –≠—Ç–æ –∫–æ—Å—Ç—ã–ª—å, –Ω–æ –¥–ª—è SPA –±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ —ç—Ç–æ —Ä–∞–±–æ—á–∏–π –≤–∞—Ä–∏–∞–Ω—Ç.
        document.getElementById('explore-btn').onclick = () => {
            if (player.energy < 10) { logMessage('Not enough energy to explore!', 'log-danger'); return; }
            consumeResources(10);
            tg.HapticFeedback.impactOccurred('medium');

            logMessage('You ventured into the unknown...', 'log-event');
            
            const newLocs = Object.keys(locations).filter(loc => loc !== player.currentLocation);
            player.currentLocation = newLocs[Math.floor(Math.random() * newLocs.length)];

            const eventRoll = Math.random();
            if (eventRoll < 0.3) { 
                const itemFound = Math.random() < 0.5 ? 'scrap' : 'mutant_meat';
                const amount = Math.floor(Math.random() * 3) + 1;
                player.inventory[itemFound] += amount;
                logMessage(`Found ${amount} ${getItemIcon(itemFound)} ${itemFound}!`, 'log-event');
            } else if (eventRoll < 0.5) { 
                const damage = Math.floor(Math.random() * 20) + 10;
                player.hp -= damage;
                logMessage(`A mutated creature attacked! Lost ${damage} HP.`, 'log-danger');
            } else { 
                logMessage('Found nothing of interest.', 'log-info');
            }
            updateUI();
        };

        document.getElementById('scavenge-btn').onclick = () => {
            if (player.energy < 5) { logMessage('Too tired to scavenge!', 'log-danger'); return; }
            consumeResources(5);
            tg.HapticFeedback.impactOccurred('light');

            logMessage('You meticulously searched the area.', 'log-event');
            
            const scrapFound = Math.floor(Math.random() * 5) + 1;
            player.inventory['scrap'] += scrapFound;
            logMessage(`Found ${scrapFound} ‚öôÔ∏è scrap!`, 'log-event');
            
            updateUI();
        };

        document.getElementById('rest-btn').onclick = () => {
            if (player.energy >= player.maxEnergy) { logMessage('You are already fully rested!', 'log-info'); return; }
            consumeResources(0, 5, 5);
            tg.HapticFeedback.impactOccurred('medium');

            const energyRestored = Math.min(50, player.maxEnergy - player.energy);
            player.energy += energyRestored;
            player.hp += 10;
            player.day++;

            logMessage(`You rested for the day. Energy +${energyRestored}, HP +10. Day ${player.day}.`, 'log-event');
            updateUI();
        };

        document.getElementById('craft-btn').onclick = () => {
            let craftOptions = '';
            for (const recipeName in craftRecipes) {
                const recipe = craftRecipes[recipeName];
                let canMake = true;
                let reqString = [];
                for (const reqItem in recipe.requires) {
                    reqString.push(`${recipe.requires[reqItem]} ${getItemIcon(reqItem)} ${reqItem}`);
                    if (player.inventory[reqItem] < recipe.requires[reqItem]) {
                        canMake = false;
                    }
                }
                const makeItem = Object.keys(recipe.makes)[0];
                const makeCount = recipe.makes[makeItem];
                
                craftOptions += `<button class="action-btn" ${!canMake ? 'disabled' : ''} onclick="performCraft('${recipeName}')">
                                    Craft ${makeCount} ${getItemIcon(makeItem)} ${makeItem} (Cost: ${reqString.join(', ')})
                                </button>`;
            }
            
            actionsDiv.innerHTML = craftOptions + `<button class="action-btn" onclick="hideCraftOptions()">Back</button>`;
        };

    </script>
</body>
</html>
